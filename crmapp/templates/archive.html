{% extends 'sidebar.html' %}
{% block content %}
{% load static %}

<style>
    .card-body {
        border-radius: 5px;
        border-top-left-radius: 50%;
        border-top-right-radius: 50%;
    }

    .cardbox {
        box-shadow: 2px 3px 3px grey;
        padding: 5px;
        background-color: white;
    }

    .cardbox:hover {
        box-shadow: 2px 8px 20px black;
        top: -5px;
    }

    .cardbox a {
        display: none;
    }

    .draggable:active {
        opacity: 0.4;
        cursor: grabbing;
    }

    /* Responsive styles */
    @media screen and (max-width: 768px) {
        .cardbox {
            width: calc(50% - 20px); /* Adjust width for smaller screens */
        }
    }

    @media screen and (max-width: 576px) {
        .cardbox {
            width: calc(100% - 20px); /* Adjust width for even smaller screens */
        }
    }
</style>

<div class="content-body">
    <div class="container-fluid">
        <div style="margin-top: 30px; text-align:center;">
            <h1 style="display: block; color: wheat; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;" class="px-3 pb-4 border-bottom">Archives</h1>
        </div>

        <div id="archivedCardsContainer" class="justify-content-center py-5" style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: start;">
            <!-- cards here -->
        </div>

        <center>
            <div id="nothing" style="display: none; min-height: 79vh;">
                <h1 style="color:white; font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Nothing Here..</h1>
            </div>
        </center>

        <div style="min-height: 20vh;"></div>
    </div>
</div>

<script>
    // Load archived cards from local storage
    let archivedCards = JSON.parse(localStorage.getItem('archivedCards')) || [];
    // Get container element
    let archivedCardsContainer = document.getElementById('archivedCardsContainer');
    let oopsMsg = document.getElementById('nothing');

    // Function to remove a card from the DOM and update local storage
    function removeCard(index) {
        // Remove the corresponding card from the archivedCards array
        archivedCards.splice(index, 1);
        // Save the updated archivedCards array to local storage
        saveToLocalStorage();
        // Clear the container
        archivedCardsContainer.innerHTML = '';
        // Re-display archived cards
        displayArchivedCards();
    }

    // Function to display archived cards
    function displayArchivedCards() {
        if (archivedCards.length === 0) {
            oopsMsg.style.display = 'block';
        } else {
            oopsMsg.style.display = 'none';
            archivedCards.forEach(function(cardHTML, index) {
                // Create a div element to contain each archived card
                let cardDiv = document.createElement('div');
                cardDiv.classList.add('card', 'draggable', 'cardbox');
                cardDiv.style.width = '18rem';
                cardDiv.innerHTML = cardHTML; // Set inner HTML to the archived card content

                // Create a button element to remove the corresponding card
                let removeButton = document.createElement('button');
                removeButton.classList.add('btn', 'btn-warning', 'my-3');
                removeButton.style.width = '50%';
                removeButton.style.marginLeft = '25%';
                removeButton.textContent = 'Unarchive';
                removeButton.addEventListener('click', function() {
                    // Call removeCard function with the corresponding index
                    removeCard(index);

                    // Remove the card from the DOM
                    cardDiv.remove();
                });

                // Append the button to the card div
                cardDiv.appendChild(removeButton);

                // Append the card div to the container
                archivedCardsContainer.appendChild(cardDiv);
            });
        }
    }

    // Display archived cards initially
    displayArchivedCards();

    // Function to save archived cards to local storage
    function saveToLocalStorage() {
        localStorage.setItem('archivedCards', JSON.stringify(archivedCards));
    }
</script>

{% endblock %}
